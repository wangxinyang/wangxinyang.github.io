<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>elasticsearchについて</title>
      <link href="/2020/07/22/elasticsearch%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
      <url>/2020/07/22/elasticsearch%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="Elasticsearch立上げ際に注意すべき点"><a href="#Elasticsearch立上げ際に注意すべき点" class="headerlink" title="Elasticsearch立上げ際に注意すべき点"></a>Elasticsearch立上げ際に注意すべき点</h1><ul><li><p><strong>JDKが必要です</strong>。</p></li><li><p><strong>ルートユーザーはElasticsearchを立ち上げることが支持しません。普通ユーザーを増加しないといけない。</strong></p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 新しいグループを作る 名前はお好きにしてください</span><br><span class="line">groupadd es</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 新しいユーザーを作る 「-g」はこのユーザーはなんのグループに所属すること</span><br><span class="line">useradd es -g es</span><br><span class="line"></span><br><span class="line"> &#x2F;&#x2F; パスワードを設定する</span><br><span class="line">passwd es</span><br></pre></td></tr></table></figure><ul><li><strong>リモート訪問できるように設定すること<br>Elasticsearchのconfigフォルダーのelasticsearch.ymlを修正する</strong></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;インストールされたフォルダー&#x2F;elasticsearch-6.8.0&#x2F;config</span><br><span class="line"></span><br><span class="line">vi elasticsearch.yml</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 0.0.0.0に設定すればいいです</span><br><span class="line">network.host: 0.0.0.0</span><br></pre></td></tr></table></figure><ul><li><strong>立上げ際にERRORになってしまって</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[1]: max file descriptors [4096] for elasticsearch process is too low, increase to at least [65535]</span><br><span class="line"></span><br><span class="line">ルートユーザーを切替、limits.confを修正する</span><br><span class="line">vi &#x2F;etc&#x2F;security&#x2F;limits.conf</span><br><span class="line"></span><br><span class="line">* soft nproc 4096</span><br><span class="line">* soft nofile 655356</span><br><span class="line">* hard nproc 4096</span><br><span class="line">* hard nofile 655356</span><br><span class="line">修正完成した後、再登録が必要です</span><br><span class="line">ulimit -Hn</span><br><span class="line">ulimit -Sn</span><br><span class="line">ulimit -Hu</span><br><span class="line">ulimit -Su</span><br><span class="line">上記のコマンドは修正成功するかどうかが確認できます</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[2]: max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]</span><br><span class="line"></span><br><span class="line"> vi &#x2F;etc&#x2F;sysctl.conf</span><br><span class="line"></span><br><span class="line">「vm.max_map_count&#x3D;655360」を増加します</span><br><span class="line"></span><br><span class="line">「syscyl -p」というコマンドは修正成功するかどうかが確認できます</span><br><span class="line"></span><br><span class="line">[3]: max number of threads [1024] for user [leyou] is too low, increase to at least [4096]</span><br><span class="line"></span><br><span class="line">vi &#x2F;etc&#x2F;security&#x2F;limits.d&#x2F;20-nproc.conf</span><br><span class="line"></span><br><span class="line">*          soft    nproc     4096</span><br><span class="line">星マークは自分のESのユーザーを修正するようにしてください</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
